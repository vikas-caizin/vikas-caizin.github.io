(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{moEF:function(a,e,t){"use strict";t.r(e);var r=t("8Y7J");class i{}var n=t("pMnS"),d=t("1Txd"),o=t("yFBK"),l=t("MqE1"),m=t("s7LF"),s=t("PJ54"),p=t("Z3BZ"),u=t("EApP"),c=t("M+tS"),f=t("3yNS"),b=t("IcCv"),h=t("A+V5"),g=t("SVse"),S=t("K/Md"),v=t("7seC"),F=t("iInd"),I=t("hUUB"),E=t("s6ns"),A=t("u1gT"),D=t("TfA5"),_=t("Z725"),C=t("mrSG"),M=t("qHnB"),R=t("HTWL"),T=t("wd/R");class y{constructor(a,e,t,r,i,n){this.activatedRoute=a,this._router=e,this.formService=t,this.settingsService=r,this.formDataService=i,this.toasterService=n,this.formSchema=[],this.isFormFill=!0}ngOnInit(){this.logInEmployeeId=localStorage.getItem("E_Id"),this.activatedRoute.params.subscribe(a=>{this.currentid=a.id,this.dataEntryId=a.id1,this.currentid&&(this.loading=!0,this.formSchema=[],this.formService.getFormDetail(this.currentid).subscribe(a=>{a&&a.success?(this.logInEmployeeId===a.response.form.approverId&&(this.isApproverFilling=!0),this.formName=a.response.form.formName,this.formSchema=a.response.form.formElements,this.formId=a.response.form.formId,this.dataEntryId&&this.formService.getFormDataById(this.dataEntryId).subscribe(a=>{a&&a.response&&a.success&&(this.formDataValue=a.response.data,this.dataCaptureDate=a.response.dataCaptureDate)},a=>{this.formDataValue=[]})):(this.toasterService.error(R.a.PLEASE_TRY_AGAIN),this._router.navigate(["/forms"])),this.loading=!1},a=>{this.loading=!1,403===a.status?(this.toasterService.error(a.error.message),this._router.navigate(["/forms"])):this.toasterService.error(R.a.PLEASE_TRY_AGAIN)}))})}getFillPermissions(a){return a.fill}onFormSubmit(a){return Object(C.__awaiter)(this,void 0,void 0,function*(){let e,t=a.linkedData,r=a.fillAgain,i=(a=a.value).datePickerForForm;if(!i)return void this.toasterService.error(R.a.PLEASE_SELECT_DATE);e=T(i).format("YYYY-MM-DDTHH:mm:00");let n=[];try{if(this.formSchema.length)for(let a of this.formSchema)"heading"!==a.field&&"paragraph"!==a.field&&"section_break"!==a.field&&"submit_btn"!==a.field&&n.push({label:a.label,uuid:a.uuid,isMetricField:a.metricEnabled,unitOfMeasurement:a.metricEnabled?a.unitOfMeasurement:void 0,field:a.field});let t=Object.keys(a);for(let r=0;r<n.length;r++){let i,d;n[r].isMetricField&&(i=e,d=e);let o=a[t[r]];if("time"===n[r].field&&(o=T(o).format("hh:mm A")),n[r]={label:n[r].label,key:t[r],value:o,uuid:n[r].uuid,isMetricField:n[r].isMetricField,unitOfMeasurement:n[r].unitOfMeasurement,dataCaptureStart:i||void 0,dataCaptureEnd:d||void 0},n[r].value&&n[r].value instanceof File){const e=yield this.uploadFile(a[t[r]],this.currentid);if(!e||!e.success)throw"Error occurred while uploading file";n[r].value=e.response.fileURL}delete a[t[r]]}}catch(o){n=[]}let d=t;if(this.dataEntryId)this.formDataService.editFormData({formSubmissionUuid:this.dataEntryId,data:n,dataCaptureDate:e}).subscribe(a=>{a&&a.success&&(r?(this.toasterService.success(R.a.FORM_DATA_UPDATED_SUCCESS),window.location.reload()):(this.toasterService.success(R.a.FORM_DATA_UPDATED_SUCCESS),this._router.navigateByUrl("/forms/linked-data-listing")))},a=>{this.toasterService.error(400===a.status?R.a.FORM_DATA_REQUEST_INVALID:403===a.status||405===a.status||205===a.status?a.error.message:R.a.PLEASE_TRY_AGAIN)});else{const a={formId:this.formId,data:n,dataCaptureDate:e};d&&(a.linkedFormId=d.linkedFormId,a.linkedFormSubmissionId=d.linkedFormSubmissionId),this.formDataService.addFormData(a).subscribe(a=>{a&&a.success&&(r?(this.toasterService.success(R.a.FORM_DATA_SAVED_SUCCESS),window.location.reload()):(this.toasterService.success(R.a.FORM_DATA_SAVED_SUCCESS),this._router.navigateByUrl("/forms/linked-data-listing")))},a=>{this.toasterService.error(400===a.status?R.a.FORM_DATA_REQUEST_INVALID:403===a.status||205===a.status?a.error.message:R.a.PLEASE_TRY_AGAIN)})}})}getIndex(a,e){return a.findIndex(a=>a.key===e)}uploadFile(a,e){return Object(C.__awaiter)(this,void 0,void 0,function*(){return this.settingsService.uploadFile({file:a,parentId:e}).toPromise()})}}var L=r["\u0275crt"]({encapsulation:0,styles:[[".form-fill-container[_ngcontent-%COMP%]{padding-left:32px;padding-right:32px;padding-top:3rem}.form-name-cls[_ngcontent-%COMP%]{margin-top:16px;padding-left:16px;padding-bottom:16px;font-size:18px;font-weight:500}.forms-listing-container[_ngcontent-%COMP%]{padding-right:32px!important;background-color:#fff!important}"]],data:{}});function U(a){return r["\u0275vid"](0,[(a()(),r["\u0275eld"](0,0,null,null,1,"app-form-renderer",[],null,[[null,"formSchemaChange"],[null,"onSubmit"]],function(a,e,t){var r=!0,i=a.component;return"formSchemaChange"===e&&(r=!1!==(i.formSchema=t)&&r),"onSubmit"===e&&(r=!1!==i.onFormSubmit(t)&&r),r},d.c,d.b)),r["\u0275did"](1,114688,null,0,o.a,[l.a,m.f,s.a,p.a,u.j],{formSchema:[0,"formSchema"],isFormFill:[1,"isFormFill"],formDataValue:[2,"formDataValue"],isApproverFilling:[3,"isApproverFilling"],dataCaptureDate:[4,"dataCaptureDate"]},{onSubmit:"onSubmit"})],function(a,e){var t=e.component;a(e,1,0,t.formSchema,t.isFormFill,t.formDataValue,t.isApproverFilling,t.dataCaptureDate)},null)}function N(a){return r["\u0275vid"](0,[(a()(),r["\u0275eld"](0,0,null,null,14,"div",[["class","form-fill-container"]],null,null,null,null,null)),(a()(),r["\u0275eld"](1,0,null,null,13,"ibm-tabs",[],null,null,null,c.b,c.a)),r["\u0275did"](2,1097728,null,2,f.a,[],null,null),r["\u0275qud"](603979776,1,{tabs:1}),r["\u0275qud"](335544320,2,{tabHeaders:0}),(a()(),r["\u0275eld"](5,0,null,0,5,"ibm-tab",[["heading","Form"]],[[1,"id",0]],null,null,b.b,b.a)),r["\u0275did"](6,114688,[[1,4]],0,h.a,[],{heading:[0,"heading"]},null),(a()(),r["\u0275eld"](7,0,null,0,1,"div",[["class","form-name-cls"]],null,null,null,null,null)),(a()(),r["\u0275ted"](8,null,["",""])),(a()(),r["\u0275and"](16777216,null,0,1,null,U)),r["\u0275did"](10,16384,null,0,g.NgIf,[r.ViewContainerRef,r.TemplateRef],{ngIf:[0,"ngIf"]},null),(a()(),r["\u0275eld"](11,0,null,0,3,"ibm-tab",[["heading","Past Data"]],[[1,"id",0]],null,null,b.b,b.a)),r["\u0275did"](12,114688,[[1,4]],0,h.a,[],{heading:[0,"heading"]},null),(a()(),r["\u0275eld"](13,0,null,0,1,"app-linked-form-data-listing",[],null,null,null,S.c,S.b)),r["\u0275did"](14,114688,null,0,v.a,[F.l,l.a,F.a,I.a,u.j,E.e,A.a,D.a,_.a,s.a],{isFromFill:[0,"isFromFill"]},null)],function(a,e){var t=e.component;a(e,6,0,"Form"),a(e,10,0,t.formSchema&&t.formSchema.length&&(!t.dataEntryId||t.formDataValue&&t.formDataValue.length)&&!t.loading),a(e,12,0,"Past Data"),a(e,14,0,"true")},function(a,e){var t=e.component;a(e,5,0,r["\u0275nov"](e,6).attrClass),a(e,8,0,t.formName),a(e,11,0,r["\u0275nov"](e,12).attrClass)})}function P(a){return r["\u0275vid"](0,[(a()(),r["\u0275eld"](0,0,null,null,1,"app-form-fill",[],null,null,null,N,L)),r["\u0275did"](1,114688,null,0,y,[F.a,F.l,l.a,M.a,I.a,u.j],null,null)],function(a,e){a(e,1,0)},null)}var O=r["\u0275ccf"]("app-form-fill",y,P,{},{},[]),k=t("No7X"),w=t("bIR2"),j=t("NpSD"),x=t("cbbC"),V=t("Gv0t"),H=t("cN2v"),q=t("gKtx"),G=t("GRwY"),B=t("P08G"),K=t("quVZ"),Y=t("t7MO"),z=t("I0pH"),X=t("sstc"),Z=t("t68o"),Q=t("lQmW"),J=t("/5xB"),W=t("zTFV"),$=t("+GeB"),aa=t("jcvr"),ea=t("mEpm"),ta=t("ZHEK"),ra=t("RJDq"),ia=t("U6oK"),na=t("i3NF"),da=t("QQfA"),oa=t("IP0z"),la=t("POq0"),ma=t("Tq4R"),sa=t("rAFq"),pa=t("4D9t"),ua=t("bMPK"),ca=t("UiI2"),fa=t("/HVE"),ba=t("uvqg"),ha=t("f8KH"),ga=t("maoM"),Sa=t("pQSL"),va=t("PsxR"),Fa=t("X/pD"),Ia=t("XX5M");class Ea{}var Aa=t("nU9L"),Da=t("+IpF"),_a=t("jQIA"),Ca=t("+NSx"),Ma=t("jPU2"),Ra=t("h6sn"),Ta=t("nXcq"),ya=t("eUdb"),La=t("SpJC"),Ua=t("IxoR"),Na=t("P5T4"),Pa=t("H+bR"),Oa=t("nhzO"),ka=t("cbyg"),wa=t("niTG"),ja=t("XBWk"),xa=t("4UMp"),Va=t("5F/F"),Ha=t("3ezH"),qa=t("zMNK"),Ga=t("hOhj"),Ba=t("5GAg"),Ka=t("jRYl"),Ya=t("KL2N"),za=t("QX+E"),Xa=t("Lb5T"),Za=t("FS8H"),Qa=t("ctAq"),Ja=t("kEMu"),Wa=t("vjI9"),$a=t("yKc8"),ae=t("ezSh"),ee=t("pVHs"),te=t("ixoK"),re=t("LuTi"),ie=t("h5jA"),ne=t("9Ntg"),de=t("wqUn"),oe=t("HSTZ"),le=t("OZcg"),me=t("nw/W"),se=t("EJfY"),pe=t("Tl03"),ue=t("+5LG"),ce=t("HyvF"),fe=t("fF59"),be=t("GMRT"),he=t("UDqP"),ge=t("bzBv"),Se=t("+Inj"),ve=t("CX5l"),Fe=t("aI0y"),Ie=t("kdZC"),Ee=t("XdKZ"),Ae=t("4vLU"),De=t("Xd0L"),_e=t("cUpR"),Ce=t("Fwaw"),Me=t("Gi4r"),Re=t("/m4c"),Te=t("0L0y"),ye=t("Jbdn"),Le=t("L5ej"),Ue=t("6TIQ"),Ne=t("+nmx"),Pe=t("EFU/");t.d(e,"FormFillModuleNgFactory",function(){return Oe});var Oe=r["\u0275cmf"](i,[],function(a){return r["\u0275mod"]([r["\u0275mpd"](512,r.ComponentFactoryResolver,r["\u0275CodegenComponentFactoryResolver"],[[8,[n.a,O,d.a,k.a,w.a,j.a,x.a,V.a,H.a,q.a,G.a,B.a,K.a,S.a,Y.a,z.a,X.a,Z.a,Q.a,J.a,W.a,$.a,aa.a]],[3,r.ComponentFactoryResolver],r.NgModuleRef]),r["\u0275mpd"](4608,g.NgLocalization,g.NgLocaleLocalization,[r.LOCALE_ID,[2,g["\u0275angular_packages_common_common_a"]]]),r["\u0275mpd"](4608,m.C,m.C,[]),r["\u0275mpd"](4608,m.f,m.f,[]),r["\u0275mpd"](5120,ea.a,ta.a,[[3,ea.a]]),r["\u0275mpd"](5120,ra.a,ia.a,[[3,ra.a]]),r["\u0275mpd"](4608,na.a,na.a,[ra.a]),r["\u0275mpd"](4608,da.b,da.b,[da.h,da.d,r.ComponentFactoryResolver,da.g,da.e,r.Injector,r.NgZone,g.DOCUMENT,oa.b,[2,g.Location]]),r["\u0275mpd"](5120,da.i,da.j,[da.b]),r["\u0275mpd"](4608,la.a,la.a,[]),r["\u0275mpd"](5120,ma.b,ma.d,[da.b]),r["\u0275mpd"](4608,ma.e,ma.e,[da.b,r.Injector,[2,g.Location],ma.b,[2,ma.a],[3,ma.e],da.d]),r["\u0275mpd"](4608,sa.a,sa.a,[]),r["\u0275mpd"](5120,pa.a,pa.c,[da.b]),r["\u0275mpd"](4608,ua.a,ca.a,[[2,ua.b],fa.a]),r["\u0275mpd"](5120,ba.a,ha.a,[[3,ba.a]]),r["\u0275mpd"](4608,s.a,s.a,[r.ComponentFactoryResolver,ra.a]),r["\u0275mpd"](4608,ga.a,ga.a,[r.ComponentFactoryResolver,r.Injector,ra.a]),r["\u0275mpd"](4608,p.a,p.a,[Sa.a]),r["\u0275mpd"](4608,va.a,va.a,[Sa.a]),r["\u0275mpd"](4608,Fa.a,Fa.a,[Sa.a]),r["\u0275mpd"](4608,Ia.a,Ia.a,[Sa.a]),r["\u0275mpd"](4608,M.a,M.a,[Sa.a]),r["\u0275mpd"](4608,_.a,_.a,[]),r["\u0275mpd"](5120,E.c,E.d,[da.b]),r["\u0275mpd"](135680,E.e,E.e,[da.b,r.Injector,[2,g.Location],[2,E.b],E.c,[3,E.e],da.d]),r["\u0275mpd"](4608,l.a,l.a,[Sa.a]),r["\u0275mpd"](4608,I.a,I.a,[Sa.a]),r["\u0275mpd"](4608,A.a,A.a,[Sa.a]),r["\u0275mpd"](1073742336,g.CommonModule,g.CommonModule,[]),r["\u0275mpd"](1073742336,F.p,F.p,[[2,F.u],[2,F.l]]),r["\u0275mpd"](1073742336,Ea,Ea,[]),r["\u0275mpd"](1073742336,Aa.a,Aa.a,[]),r["\u0275mpd"](1073742336,m.B,m.B,[]),r["\u0275mpd"](1073742336,m.l,m.l,[]),r["\u0275mpd"](1073742336,m.x,m.x,[]),r["\u0275mpd"](1073742336,Da.c,Da.c,[]),r["\u0275mpd"](1073742336,_a.a,_a.a,[]),r["\u0275mpd"](1073742336,ta.c,ta.c,[]),r["\u0275mpd"](1073742336,ia.b,ia.b,[]),r["\u0275mpd"](1073742336,Ca.c,Ca.c,[]),r["\u0275mpd"](1073742336,Ma.a,Ma.a,[]),r["\u0275mpd"](1073742336,Ra.a,Ra.a,[]),r["\u0275mpd"](1073742336,Ta.a,Ta.a,[]),r["\u0275mpd"](1073742336,ya.c,ya.c,[]),r["\u0275mpd"](1073742336,La.a,La.a,[]),r["\u0275mpd"](1073742336,Ua.a,Ua.a,[]),r["\u0275mpd"](1073742336,Na.a,Na.a,[]),r["\u0275mpd"](1073742336,Pa.a,Pa.a,[]),r["\u0275mpd"](1073742336,Oa.a,Oa.a,[]),r["\u0275mpd"](1073742336,ka.a,ka.a,[]),r["\u0275mpd"](1073742336,wa.c,wa.c,[]),r["\u0275mpd"](1073742336,ja.c,ja.c,[]),r["\u0275mpd"](1073742336,xa.a,xa.a,[]),r["\u0275mpd"](1073742336,Va.a,Va.a,[]),r["\u0275mpd"](1073742336,Ha.a,Ha.a,[]),r["\u0275mpd"](1073742336,oa.a,oa.a,[]),r["\u0275mpd"](1073742336,qa.f,qa.f,[]),r["\u0275mpd"](1073742336,fa.b,fa.b,[]),r["\u0275mpd"](1073742336,Ga.b,Ga.b,[]),r["\u0275mpd"](1073742336,da.f,da.f,[]),r["\u0275mpd"](1073742336,la.b,la.b,[]),r["\u0275mpd"](1073742336,Ba.a,Ba.a,[]),r["\u0275mpd"](1073742336,Ka.a,Ka.a,[]),r["\u0275mpd"](1073742336,Ya.a,Ya.a,[]),r["\u0275mpd"](1073742336,za.a,za.a,[]),r["\u0275mpd"](1073742336,za.b,za.b,[]),r["\u0275mpd"](1073742336,Xa.b,Xa.b,[]),r["\u0275mpd"](1073742336,Za.b,Za.b,[]),r["\u0275mpd"](1073742336,ha.b,ha.b,[]),r["\u0275mpd"](1073742336,Qa.b,Qa.b,[]),r["\u0275mpd"](1073742336,Ja.a,Ja.a,[]),r["\u0275mpd"](1073742336,Wa.b,Wa.b,[]),r["\u0275mpd"](1073742336,$a.a,$a.a,[]),r["\u0275mpd"](1073742336,ae.a,ae.a,[]),r["\u0275mpd"](1073742336,ee.a,ee.a,[]),r["\u0275mpd"](1073742336,te.c,te.c,[]),r["\u0275mpd"](1073742336,re.d,re.d,[]),r["\u0275mpd"](1073742336,ie.c,ie.c,[]),r["\u0275mpd"](1073742336,ne.c,ne.c,[]),r["\u0275mpd"](1073742336,de.b,de.b,[]),r["\u0275mpd"](1073742336,oe.a,oe.a,[]),r["\u0275mpd"](1073742336,le.a,le.a,[]),r["\u0275mpd"](1073742336,me.b,me.b,[]),r["\u0275mpd"](1073742336,se.a,se.a,[]),r["\u0275mpd"](1073742336,pe.a,pe.a,[]),r["\u0275mpd"](1073742336,ue.a,ue.a,[]),r["\u0275mpd"](1073742336,ce.a,ce.a,[]),r["\u0275mpd"](1073742336,fe.b,fe.b,[]),r["\u0275mpd"](1073742336,be.b,be.b,[]),r["\u0275mpd"](1073742336,he.b,he.b,[]),r["\u0275mpd"](1073742336,ge.b,ge.b,[]),r["\u0275mpd"](1073742336,Se.a,Se.a,[]),r["\u0275mpd"](1073742336,ve.a,ve.a,[]),r["\u0275mpd"](1073742336,Fe.a,Fe.a,[]),r["\u0275mpd"](1073742336,Ie.b,Ie.b,[]),r["\u0275mpd"](1073742336,Ee.b,Ee.b,[]),r["\u0275mpd"](1073742336,Ae.b,Ae.b,[]),r["\u0275mpd"](1073742336,De.e,De.e,[[2,De.b],[2,_e.f]]),r["\u0275mpd"](1073742336,E.k,E.k,[]),r["\u0275mpd"](1073742336,De.g,De.g,[]),r["\u0275mpd"](1073742336,Ce.c,Ce.c,[]),r["\u0275mpd"](1073742336,Me.a,Me.a,[]),r["\u0275mpd"](1073742336,Re.a,Re.a,[]),r["\u0275mpd"](1073742336,Te.a,Te.a,[]),r["\u0275mpd"](1073742336,ye.a,ye.a,[]),r["\u0275mpd"](1073742336,Le.a,Le.a,[]),r["\u0275mpd"](1073742336,Ue.a,Ue.a,[]),r["\u0275mpd"](1073742336,Ne.a,Ne.a,[]),r["\u0275mpd"](1073742336,i,i,[]),r["\u0275mpd"](1024,F.j,function(){return[[{path:"",component:y}],[{path:"",component:o.a}],[{path:"",component:v.a},{path:":source/filters",component:v.a}],[{path:"",component:o.a}]]},[]),r["\u0275mpd"](256,Pe.a,za.c,[])])})}}]);